{% extends "base.html" %}
{% load static %}
{% block content %}
{% load tags %}
		
<section class="bg-img1 txt-center p-lr-15 p-tb-92" style="background-image: url({% static 'sitio/images/Sitio/coleccion3.jpg' %});">
	<h2 class="ltext-105 cl0 txt-center">
		Datos para el pago
	</h2>
</section>	
	<!-- Shoping Cart -->
	
		<div class="container">
			<div class="row">
				<div class="col-sm-12">
					<div class="m-l-25 m-r--38 m-lr-0-xl">
						<div class="wrap-table-shopping-cart">
							<table class="table-shopping-cart carrito">
								<tr class="table_head">
									<th class="column-1">No de order</th>
									<th class="column-2">Fecha</th>
									<th class="column-4">Estado</th>
									<th class="column-5">Total</th>
									<th class="column-6">Comprobante de pago</th>
								</tr>
								{% for pedido in pedidos %}
								<tr class="table_row {{item.product.id}}{{item.talla|replace}}">
									<td class="column-1">{{pedido.id}}</td>
									<td class="column-2">{{pedido.fecha}} </td>
									<td class="column-4">{% if pedido.estado_pedido == "1" %}Pago Pendiente{% elif pedido.estado_pedido == "2" %}Pagado{% elif pedido.estado_pedido == "3" %}En camino{% elif pedido.estado_pedido == "4" %}Entregado{%endif%}</td>
									<td class="column-5">{{pedido.total}}</td>
									<form action="/subircomprobante/{{pedido.id}}/" method="POST" class="bg0 p-t-75 p-b-85" enctype="multipart/form-data">
									{% csrf_token %}
									<td class="column-6"><input type="file" name=""></td>
									</form>
								</tr>
								{% endfor %}

								
							</table>
						</div>
					</div>
				</div>

			</div>	
		</div>
	
		
	
		

{% endblock %}

{% block js %}

<script type="text/javascript">
$("#pagoxxo").on('click', function(event) {
	$("#formpago").attr('action', '/crearpedido2/');
	$("#formpago").submit();
});

$("#tipoenvio").on('change', function(event) {
	if ($(this).val() == 2) {
		$("#ingdatosenvio").show();
		$("#nombre").prop('required',true);
		$("#email").prop('required',true);
		$("#telefono").prop('required',true);
		$("#codigo_postal").prop('required',true);
		$("#direccion").prop('required',true);
		$("#exterior").prop('required',true);
		$("#pais").prop('required',true);
		$("#estado").prop('required',true);
		$("#colonia").prop('required',true);
	}
	else{
		$("#ingdatosenvio").hide();
		$("#nombre").removeAttr('required');
		$("#email").removeAttr('required');
		$("#telefono").removeAttr('required');
		$("#codigo_postal").removeAttr('required');
		$("#direccion").removeAttr('required');
		$("#exterior").removeAttr('required');
		$("#pais").removeAttr('required');
		$("#estado").removeAttr('required');
		$("#colonia").removeAttr('required');
	}
});

$("#codigo_postal").keyup(function(event) {
	codigo = $(this).val();
	$.ajax({
		             url : 'https://api-codigos-postales.herokuapp.com/v2/codigo_postal/'+codigo, // the endpoint,commonly same url
		             type : "GET", // http method
		             data : {}, // data sent with the post request
		     success : function(json) {
		     	console.log(json)
		     	$("#ciudad").val(json.municipio);
		     	$("#estado").val(json.estado);
		     	valores = "<option disabled selected value='Seleccione una opciÃ³n'>Seleccione una opcion</option>"
		     	$.each(json.colonias, function(index, val) {
		     		valores += "<option value='"+val+"'>"+val+"</option>";
		     	});
		     	$("#colonia").html(valores);
		     }
		 });
});
</script>

{% endblock %}